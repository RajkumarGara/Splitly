<template name="History">
	<style>
		.history-table tbody td {
			vertical-align: middle;
		}
		.history-table .btn-group .btn {
			padding: 0.5rem 0.75rem;
			font-size: 1rem;
		}
		.history-table th:nth-child(1),
		.history-table td:nth-child(1) {
			width: 50px;
			text-align: center;
		}
		.history-table th:nth-child(2),
		.history-table td:nth-child(2) {
			width: 40%;
		}
		.history-table th:nth-child(3),
		.history-table td:nth-child(3) {
			width: 40%;
		}
		.history-table th:nth-child(4),
		.history-table td:nth-child(4) {
			width: 100px;
			text-align: right;
			padding-right: 2rem;
		}
	</style>
	
	<div class="position-relative mb-3">
		<h2 class="page-title">
			<i class="bi bi-clock-history"></i>
			History
		</h2>
		{{#if hasSelection}}
			<button class="btn btn-danger position-absolute top-0 end-0" id="deleteSelectedBtn">
				<i class="bi bi-trash"></i> Delete {{selectedCount}} Selected
			</button>
		{{/if}}
	</div>
	
	{{#if showHelpInfo}}
		<div class="alert alert-info alert-dismissible fade show" role="alert">
			<i class="bi bi-info-circle"></i> <strong>History:</strong> View all your receipts. Click a row to see details. Select multiple receipts to delete in bulk.
			<button type="button" class="btn-close" id="hideHelpBtn"></button>
		</div>
	{{/if}}
	
	{{#if hasBills}}
		<div class="table-responsive">
			<table class="table table-striped table-hover history-table">
				<thead>
					<tr>
						<th class="table-checkbox-col">
							<input type="checkbox" class="form-check-input" id="selectAllCheckbox" data-check-all="true">
						</th>
						<th>Store</th>
						<th>Date</th>
						<th class="table-actions-col">Delete</th>
					</tr>
				</thead>
				<tbody>
					{{#each bills}}
						<tr>
							<td>
								<input type="checkbox" class="form-check-input receipt-checkbox" data-id="{{_id}}" data-selected="{{isSelected _id}}">
							</td>
							<td>
								<a href="/split/{{_id}}" class="text-decoration-none store-name-link">
									{{storeName}}
								</a>
							</td>
							<td>
								<small class="text-muted">{{createdAt}}</small>
							</td>
							<td>
								<button class="btn btn-outline-danger delete-single-btn" data-id="{{_id}}" title="Delete">
									<i class="bi bi-trash"></i>
								</button>
							</td>
						</tr>
					{{/each}}
				</tbody>
			</table>
		</div>
	{{else}}
		<div class="text-center py-5">
			<i class="bi bi-inbox empty-state-icon-muted"></i>
			<p class="text-muted mt-3">No receipts yet. Scan or upload a receipt to get started!</p>
			<a href="/" class="btn btn-primary">
				<i class="bi bi-plus-circle"></i> Add Receipt
			</a>
		</div>
	{{/if}}
</template>